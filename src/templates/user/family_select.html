{% extends 'base.html' %}
{% load static %}

{% block title %}プロフィール一覧{% endblock %}

{% block css %}
  <link rel="stylesheet" href="{% static 'css/components/button.css' %}">
  <link rel="stylesheet" href="{% static 'css/components/form.css' %}">
  <link rel="stylesheet" href="{% static 'css/components/top_nav.css' %}">
  <link rel="stylesheet" href="{% static 'css/components/bottom_nav.css' %}">
  <link rel="stylesheet" href="{% static 'css/user/user.css' %}">
{% endblock %}

{% block header %}
{% include "components/top_nav.html" %}
{% endblock %}

{% block page_title %}家族のプロフィール一覧{% endblock %}
{% block content %}
<p class="link_set"><a href="/members/new/">＋ プロフィールを追加</a></p>

  <!-- <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px;"> -->
  <!-- ゆーせーが下記をコメントアウトしました -->
  <!-- <div class="profile_container">
    {% for m in members %}
      <div class="profile_section">
        <div><strong>{{ m.display_name }}</strong> <small>({{ m.role }})</small></div>
        {% if m.nickname %}<div>Nickname: {{ m.nickname }}</div>{% endif %}
        {% if m.avatar_url %}<div><img src="{{ m.avatar_url }}" alt="" style="max-width:100%;height:auto"></div>{% endif %}
        <a href="/personal_page/{{ m.id }}">
          <img src="{% static 'img/kajimaru_mikan.svg' %}" alt="かじまるみかん" class="profile_kajimaru_mikan">
        </a> -->
        <!-- <p class="profile_add_select">
          <a href="/profiles/{{ m.id }}/enter/">このプロフィールで入室</a> |
          <a href="/members/{{ m.id }}/edit/">編集</a> |
          <a href="/members/{{ m.id }}/delete/">削除</a>
        </p> -->
      <!-- </div>
    {% empty %}
      <p>プロフィールがありません。まず追加してください。</p>
    {% endfor %}
  </div> -->
  <!-- ここまでコメントアウトしました -->

  <!-- ゆーせー追加分 -->
  <div class="profile_container">
      {% for m in members %}
        <div class="profile_section">
          {# ▼ 選択したアバター（avatar_key） #}
          <!-- <img
            src="{% static 'img/avatars/' %}{{ m.avatar_key|default:'boy' }}.png"
            alt="{{ m.display_name }}のアイコン"
            class="profile_avatar_img"
          > -->

          {# ▼ 名前など #}
          <div><strong>{{ m.display_name }}</strong> <small>({{ m.role }})</small></div>
          {% if m.nickname %}
            <div>Nickname: {{ m.nickname }}</div>
          {% endif %}

          {# ▼ 入室ボタン（今はダミーで personal_page。必要に応じて変更） #}
          <div class="profile_add_select">
            <a href="/personal_page/{{ m.id }}">
              {% if m.avatar_key %}
                <img src="{% static 'img/avatars/' %}{{ m.avatar_key }}.png"
                    alt="{{ m.display_name }}のアイコンで入室"
                    class="profile_kajimaru_mikan">
              {% else %}
                <img src="{% static 'img/kajimaru_mikan.svg' %}"
                    alt="{{ m.display_name }}のデフォルトアイコンで入室"
                    class="profile_kajimaru_mikan">
              {% endif %}
            </a>
            <a href="/members/{{ m.id }}/edit/">編集</a>
          </div>
        </div>
      {% empty %}
        <p>プロフィールがありません。まず追加してください。</p>
      {% endfor %}
  </div>
  <!-- ここまでゆーせー追加分 -->

  <hr>
  <p class="link_set">
    <a href="{% url 'invite_create' %}" class="btn btn-primary" style="border-radius: 8px; font-size: 1rem; font-weight: bold; padding: 10px 20px;">
      招待コードを発行する
    </a>
  </p>
  {% for m in messages %}<p class="alert_message" style="color:red">{{ m }}</p>{% endfor %}
{% endblock %}

{% block footer %}
{% include "components/bottom_nav_before_login.html" %}
{% endblock %}

